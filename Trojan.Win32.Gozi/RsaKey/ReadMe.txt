Утилита для шифрования и цифровой подписи файлов RSAKEY
-------------------------------------------------------


1. Генерация RSA-ключей
 rsakey -g private.key public.key
создаёт два файла: private.key и public.key, содержащие соответствующие RSA-ключи

2. Шифрование и подпись файла
 rsakey -s private.key <исходный файл> <результат>
Шифрует и подписывает исходный файл и сохраняет в файл-результат.

3. Проверка подписи файла
 rsakey -v private.key <шифрованый файл>

4. Расшифровка файла
 rsakey -u private.key <шифрованый файл> <результат>
Расшифровывает и проверяет заданный шифрованый файл, и сохраняет в файл-результат.

5. Упаковка INI-файла
 rsakey -i <исходный INI-файл> <результат>
Упаковывает исходный INI-файл в бинарный формат, удаляет коментарии и сохраняет в файл-результат.



Как происходит шифрование

1. Рассчитывается MD5-хэш исходного файла.
2. Генерируется случайный RC6-ключ.
3. Файл шифруется посредством полученного RC6-ключа.
4. К файлу добавляется структура, содержащая RC6-ключ и MD5-хэш.
5. Добавленная структура шифруется посредством, заданного, секретного RSA-ключа.


Как происходит проверка и расшифровка

1. В зашифрованом файле вычисляется структура, содержащая RC6-ключ и MD5-хэш исходного файла.
2. Структура расшифровывается, заданным, открытым RSA-ключом.
3. Файл расшифровывается RC6-ключом, взятым из полученной структуры.
4. Рассчитывается MD5-хэш, полученного файла.
5. Полученный MD5-хэш сравнивается с MD5-хэшем, взятым из структуры.
